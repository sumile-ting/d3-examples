<!DOCTYPE html>
<html>
<head>
    <title>D3 方法详细示例</title>
    <script src="./d3.js"></script>
    <style>
        body svg{
          overflow: visible;
          margin-left: 100px;
        }
        .depth-tick-text {
          transform: translate(0, 7px);
        }
    </style>
</head>
<body>
    <svg width="600" height="400"></svg>
    <script>
      const data = [
    [
        260,
        3.8
    ],
    [
        268,
        4.4
    ],
    [
        270,
        3.7
    ],
    [
        255,
        4.8
    ],
    [
        258,
        4.2
    ],
    [
        258,
        4.3
    ],
    [
        278,
        7.8
    ],
    [
        285,
        7.7
    ],
    [
        230,
        35.4
    ],
    [
        270,
        3.96
    ],
    [
        285,
        3.9
    ],
    [
        245,
        5
    ],
    [
        272,
        6
    ],
    [
        267,
        6.2
    ],
    [
        226,
        16
    ],
    [
        242,
        12
    ],
    [
        244,
        8
    ],
    [
        265,
        4.5
    ],
    [
        245,
        4.5
    ],
    [
        235,
        6
    ],
    [
        265,
        5.7
    ],
    [
        237,
        5.8
    ],
    [
        232,
        11
    ],
    [
        225,
        8
    ],
    [
        222,
        7
    ],
    [
        218,
        7
    ],
    [
        230,
        9
    ],
    [
        231,
        8
    ],
    [
        216,
        6
    ],
    [
        218,
        10.2
    ],
    [
        226,
        18
    ],
    [
        225,
        13
    ],
    [
        218,
        20
    ],
    [
        225,
        25
    ],
    [
        240,
        14
    ],
    [
        198,
        15
    ],
    [
        197,
        24
    ],
    [
        206,
        14
    ],
    [
        235,
        9.5
    ],
    [
        250,
        8.5
    ],
    [
        206,
        7
    ],
    [
        255,
        5
    ],
    [
        245,
        5.5
    ],
    [
        239,
        6
    ],
    [
        255,
        5.6
    ],
    [
        245,
        4.2
    ],
    [
        250,
        3.2
    ],
    [
        226,
        7
    ],
    [
        260,
        6.5
    ],
    [
        230,
        7.5
    ],
    [
        236,
        9
    ],
    [
        241,
        5.7
    ],
    [
        236,
        8
    ],
    [
        254,
        5.4
    ],
    [
        233,
        7.25
    ],
    [
        231,
        8
    ],
    [
        232,
        8.4
    ],
    [
        226,
        9.8
    ],
    [
        250,
        5
    ],
    [
        230,
        10
    ],
    [
        230,
        10
    ],
    [
        235,
        4.5
    ],
    [
        236,
        5
    ],
    [
        255,
        5
    ],
    [
        255,
        5
    ],
    [
        248,
        6.4
    ],
    [
        245,
        4.9
    ],
    [
        240,
        9
    ],
    [
        238,
        10.5
    ],
    [
        235,
        20
    ],
    [
        250,
        22
    ],
    [
        262,
        5.5
    ],
    [
        253,
        6.5
    ],
    [
        242,
        8.4
    ],
    [
        239,
        8.8
    ],
    [
        244.7,
        9.1
    ],
    [
        248,
        6.5
    ],
    [
        253,
        7.6
    ],
    [
        256,
        12.1
    ],
    [
        259,
        19.3
    ],
    [
        274,
        23
    ],
    [
        251,
        5.76
    ],
    [
        245,
        7.8
    ],
    [
        253,
        9
    ],
    [
        250,
        10
    ],
    [
        245,
        10
    ],
    [
        265,
        4.5
    ],
    [
        255,
        6
    ],
    [
        260,
        7
    ],
    [
        270,
        7
    ],
    [
        233,
        12
    ],
    [
        237,
        13
    ],
    [
        250,
        13
    ],
    [
        230,
        20
    ],
    [
        220,
        28
    ],
    [
        239,
        30
    ],
    [
        243,
        9.9
    ],
    [
        255,
        12
    ],
    [
        249,
        12.7
    ],
    [
        231,
        23
    ],
    [
        245,
        26
    ],
    [
        230,
        177
    ],
    [
        260,
        4.8
    ],
    [
        269,
        4.9
    ],
    [
        261,
        6.5
    ],
    [
        259,
        11.5
    ],
    [
        283,
        12.5
    ],
    [
        230,
        19
    ],
    [
        235,
        49
    ],
    [
        273,
        5.8
    ],
    [
        285,
        5.7
    ],
    [
        306,
        5.2
    ],
    [
        307,
        7.2
    ],
    [
        290,
        7.7
    ],
    [
        304,
        7
    ],
    [
        273,
        12
    ],
    [
        275,
        6.5
    ],
    [
        284,
        4.2
    ],
    [
        280,
        8.9
    ],
    [
        273,
        4.4
    ],
    [
        288,
        4.8
    ],
    [
        275,
        30
    ],
    [
        262,
        12
    ],
    [
        268,
        15
    ],
    [
        274,
        10
    ],
    [
        260,
        24
    ],
    [
        250,
        15
    ],
    [
        250,
        15
    ],
    [
        245,
        20
    ],
    [
        267,
        11
    ],
    [
        275,
        13
    ],
    [
        270,
        11
    ],
    [
        270,
        6.5
    ],
    [
        284,
        7.5
    ],
    [
        274,
        7
    ],
    [
        252,
        11.9
    ],
    [
        274,
        6.4
    ],
    [
        273,
        5.4
    ],
    [
        280,
        5.9
    ],
    [
        278,
        10.3
    ],
    [
        286,
        39.4
    ],
    [
        275,
        16.6
    ],
    [
        282,
        15.9
    ],
    [
        304,
        5.35
    ],
    [
        302,
        5.8
    ],
    [
        270,
        14.2
    ],
    [
        275,
        11.5
    ],
    [
        270,
        9.9
    ],
    [
        259,
        10
    ],
    [
        303,
        12.4
    ],
    [
        288,
        15
    ],
    [
        286,
        7.6
    ],
    [
        302,
        11
    ],
    [
        234,
        8.3
    ],
    [
        289,
        10.8
    ],
    [
        266,
        10.2
    ],
    [
        265,
        6.7
    ],
    [
        263,
        7.5
    ],
    [
        266,
        9
    ],
    [
        242,
        14
    ],
    [
        310,
        5.2
    ],
    [
        305,
        9
    ],
    [
        255,
        7
    ],
    [
        283,
        8
    ],
    [
        290,
        10
    ],
    [
        265,
        11
    ],
    [
        263,
        15
    ],
    [
        256,
        8
    ],
    [
        350,
        5.5
    ],
    [
        250,
        8
    ],
    [
        240,
        9.5
    ],
    [
        278,
        8
    ],
    [
        275,
        7.4
    ],
    [
        305,
        6.5
    ],
    [
        331,
        5.4
    ],
    [
        290,
        8
    ],
    [
        262,
        9
    ],
    [
        272,
        4.8
    ],
    [
        275,
        4
    ],
    [
        285,
        5
    ],
    [
        264,
        5
    ],
    [
        266,
        5.1
    ],
    [
        258,
        12
    ],
    [
        283,
        32
    ],
    [
        281,
        11
    ],
    [
        275,
        11
    ],
    [
        284,
        19
    ],
    [
        280,
        5
    ],
    [
        288,
        6
    ],
    [
        278,
        9
    ],
    [
        290,
        7
    ],
    [
        293,
        9
    ],
    [
        286,
        7
    ],
    [
        288,
        4.5
    ],
    [
        268,
        4.4
    ],
    [
        315,
        10
    ],
    [
        280,
        4.5
    ],
    [
        300,
        8
    ],
    [
        295,
        7
    ],
    [
        325,
        8
    ],
    [
        348,
        7
    ],
    [
        300,
        4
    ],
    [
        278,
        4.5
    ],
    [
        278,
        4.3
    ],
    [
        277,
        8
    ],
    [
        275,
        4
    ],
    [
        304,
        4.8
    ],
    [
        297,
        4
    ],
    [
        300,
        4.2
    ],
    [
        300,
        7
    ],
    [
        301,
        5.6
    ],
    [
        290,
        5
    ],
    [
        273,
        4.5
    ]
]
      const svg = d3.select('svg')
      const xAxisGroup = svg.append('g').attr('class', 'x-axis-g').attr("transform", `translate(0,${svg.attr("height")})`)
      const yAxisGroup =  d3.select('svg').append('g').attr('class', 'y-axis-g').attr("transform", `translate(0,0)`)

      yAxisGroup.append('line')
        .attr('y1', 0)
        .attr('x1', 0)
        .attr('y2', svg.attr("height"))
        .attr('x2', 0)
        .attr("stroke", "black")
        .attr('stroke-width', 1)
      const drawData = []
      const yFun = (y) => 1/Math.pow(y,1/1.581)
      
      data.forEach(item => {
        drawData.push({
          x: item[0],
          y: yFun(item[1]),
          rt: item[1]
        })
      })
      const xData = data.map(item => item[0])
      const xMin = 190 ||  Math.min(...xData)
      const xMax = Math.max(...xData)
      
      const xScale = d3.scaleLinear()
          .domain([xMin, xMax])
          .range([0, svg.attr("width")]);
      var xAxis = d3.axisBottom(xScale)
      xAxisGroup.call(xAxis)



      const yMin = Math.min(...data.map(item => item[1]))
      const yMax = Math.max(...data.map(item => item[1]))

      const yTicks = []
      const originTicks = []
      if(yMin < 10) {
        for(let i = 2; i < 10; i++) {
          yTicks.push(yFun(i))
          originTicks.push(i)
        }     
      }
      if(yMax>100) {
        for(let i = 10; i < 100; i+=10) {
          yTicks.push(yFun(i))
          originTicks.push(i)
        }
        for(let i=100; i < 400; i+=100) {
          yTicks.push(yFun(i))
          originTicks.push(i)
        }
      }
      console.log("--", originTicks, yTicks)
      var yScale = d3.scaleLinear().domain([Math.max(...yTicks), Math.min(...yTicks)]).range([0,  svg.attr("height")])
      const pointGroup = d3.select('svg').append('g').attr('class', 'p-g')
      d3.select('.p-g').selectAll('.point')
      .data(drawData)
      .join('circle')
      .attr('cx', d => {
        return xScale(d.x)
      })
      .attr('cy', d => {
        return yScale(d.y)
      })
      .attr('r', 2)
      .attr('stroke', 'black')
      .attr('fill', 'red')

      yAxisGroup
        .selectAll(".depth-tick-line")
        .data(yTicks)
        .join('line')
        .attr('class', 'depth-tick-line')
        .attr('y1', d => yScale(d))
        .attr('x1', -10)
        .attr('y2', d => yScale(d))
        .attr('x2', 0)
        .attr("stroke", "black")
        .attr('stroke-width', 1)
      yAxisGroup.selectAll(".depth-tick-text")
            .data(originTicks)
            .join("text")
            .attr("class", "depth-tick-text")
            .style("fill",  "black")
            .attr("y", d => yScale(yFun(d)))
            .attr("x", -10)
            .attr("text-anchor", "end")
            
            .text(function (d) {
                return d;
            });
    </script>
</body>
</html>